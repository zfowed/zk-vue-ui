{"version":3,"sources":["webpack://zkm-vue-ui/./packages/components/web/image-upload/src/image-upload.vue?9ff4","webpack://zkm-vue-ui/./packages/components/web/image-upload/src/image-upload.vue?fb69","webpack://zkm-vue-ui/packages/components/web/image-upload/src/image-upload.vue","webpack://zkm-vue-ui/./packages/components/web/image-upload/src/image-upload.vue?e7a3","webpack://zkm-vue-ui/./packages/components/web/image-upload/src/image-upload.vue","webpack://zkm-vue-ui/./packages/components/web/image-upload/index.js"],"names":["_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_image_upload_vue_vue_type_style_index_0_id_18491148_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_image_upload_vue_vue_type_style_index_0_id_18491148_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","n","render","_vm","this","_h","$createElement","_c","_self","class","zk-image-upload-loading","isUpload","staticClass","style","uploadProgress","_v","_s","ref","attrs","view-src-list","viewSrcList","options","currentOptions","readonly","cover","on","change-file","changeFile","model","value","callback","$$v","src","expression","_t","slot","$slots","staticRenderFns","msgbox","message_box","image_uploadvue_type_script_lang_js_","name","components","zk-image-select","image_select","props","String","Object","Array","type","Boolean","required","httpRequest","Function","data","currentValue","computed","assign","watch","$emit","undefined","methods","file","_this","onProgress","e","loaded","total","onSuccess","result","onError","error","alert","closeOnClickModal","confirmButtonText","action","$refs","imageSelect","selectImage","src_image_uploadvue_type_script_lang_js_","component","componentNormalizer","image_upload","ImageUpload","install","Vue"],"mappings":"sLAAA,IAAAA,EAAAC,EAAA,QAAAC,EAAAD,EAAAE,EAAAH,GAAumBE,EAAG,0DCA1mBE,EAAA,WAA0B,IAAAC,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,MAAA,oBAA2BC,0BAAAP,EAAAQ,YAA4C,CAAAJ,EAAA,OAAYK,YAAA,4BAAuC,CAAAL,EAAA,OAAYK,YAAA,cAAAC,MAAA,gBAAAV,EAAAW,eAAA,MAAgF,CAAAP,EAAA,OAAYK,YAAA,oBAA8BL,EAAA,OAAYK,YAAA,oBAA+B,CAAAL,EAAA,QAAAJ,EAAAY,GAAAZ,EAAAa,GAAAb,EAAAW,gBAAA,aAAAP,EAAA,mBAAkFU,IAAA,cAAAC,MAAA,CAAyBC,gBAAAhB,EAAAiB,YAAAC,QAAAlB,EAAAmB,eAAAC,SAAApB,EAAAoB,SAAAC,MAAArB,EAAAqB,OAAuGC,GAAA,CAAKC,cAAAvB,EAAAwB,YAA6BC,MAAA,CAAQC,MAAA1B,EAAA,IAAA2B,SAAA,SAAAC,GAAyC5B,EAAA6B,IAAAD,GAAYE,WAAA,QAAmB,CAAA9B,EAAA+B,GAAA,cAAuBC,KAAA,UAAehC,EAAAiC,OAAA,gBAAyFjC,EAAA+B,GAAA,qBAA8BC,KAAA,iBAAvHhC,EAAA+B,GAAA,WAAA/B,EAAAY,GAAA,UAAmEoB,KAAA,kBAA0E,QAC54BE,EAAA,uCC4BAC,EAAAC,EAAA,KAAAD,OAEAE,EAAA,CACAC,KAAA,gBACAC,WAAA,CACAC,kBAAAC,EAAA,YAEAC,MAAA,CACAhB,MAAAiB,OACAzB,QAAA0B,OACA3B,YAAA4B,MACAzB,SAAA,CACA0B,KAAAC,QACAC,UAAA,GAEA3B,MAAA,CACAyB,KAAAC,QACAC,UAAA,GAEAC,YAAA,CACAH,KAAAI,SACAF,UAAA,IAGAG,KAtBA,WAuBA,OACAtB,IAAA5B,KAAAyB,MACA0B,aAAAnD,KAAAyB,MACAlB,UAAA,EACAG,eAAA,IAGA0C,SAAA,CACAlC,eADA,WAEA,OAAAyB,OAAAU,OAAA,GACArD,KAAAiB,SAAA,MAGAqC,MAAA,CACA7B,MADA,WAEAzB,KAAA4B,IAAA5B,KAAAyB,MACAzB,KAAAmD,aAAAnD,KAAAyB,OAEA0B,aALA,WAMAnD,KAAAmD,cACAnD,KAAAuD,MAAA,qBAAAC,GAEAxD,KAAAuD,MAAA,QAAAvD,KAAAmD,gBAGAM,QAAA,CACAlC,WADA,SACAmC,GAAA,IAAAC,EAAA3D,KACA0D,GAIA1D,KAAAU,eAAA,EACAV,KAAAO,UAAA,EACAP,KAAAgD,YAAA,CACAE,KAAA,CAAAQ,QACAE,WAAA,SAAAC,GACAF,EAAAjD,eAAAmD,EAAAC,OAAAD,EAAAE,MAAA,OAEAC,UAAA,SAAAC,GACAN,EAAAR,aAAAc,EACAN,EAAA/B,IAAA+B,EAAAR,aACAQ,EAAApD,UAAA,GAEA2D,QAAA,SAAAC,GACAR,EAAAR,aAAA,GACAQ,EAAA/B,IAAA,GACA+B,EAAApD,UAAA,EACA2B,EAAAkC,MAAA1B,OAAAyB,IAAA,iCACAE,mBAAA,EACAC,kBAAA,OACA5C,SAAA,SAAA6C,GACA,GAAAZ,EAAAa,MAAAC,aACA,YAAAF,EACA,OAAAZ,EAAAa,MAAAC,YAAAC,qBAzBA1E,KAAAmD,aAAA,MClFmYwB,EAAA,0BCQnYC,EAAgBjC,OAAAkC,EAAA,KAAAlC,CACdgC,EACA7E,EACAmC,GACF,EACA,KACA,WACA,MAIe6C,EAAAF,UCjBfG,EAAYC,QAAU,SAAUC,GAC9BA,EAAIL,UAAUG,EAAY1C,KAAM0C,IAGnBA","file":"zkm-vue-ui.umd.min.zk-image-upload.js","sourcesContent":["import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./image-upload.vue?vue&type=style&index=0&id=18491148&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./image-upload.vue?vue&type=style&index=0&id=18491148&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:['zk-image-upload', { 'zk-image-upload-loading': _vm.isUpload }]},[_c('div',{staticClass:\"zk-image-upload-progress\"},[_c('div',{staticClass:\"zk-progress\",style:((\"padding-top: \" + _vm.uploadProgress + \"%;\"))},[_c('div',{staticClass:\"zk-progress-bar\"}),_c('div',{staticClass:\"zk-progress-text\"},[_c('span',[_vm._v(_vm._s(_vm.uploadProgress)+\"%\")])])])]),_c('zk-image-select',{ref:\"imageSelect\",attrs:{\"view-src-list\":_vm.viewSrcList,\"options\":_vm.currentOptions,\"readonly\":_vm.readonly,\"cover\":_vm.cover},on:{\"change-file\":_vm.changeFile},model:{value:(_vm.src),callback:function ($$v) {_vm.src=$$v},expression:\"src\"}},[_vm._t(\"label\",null,{\"slot\":\"label\"}),(!_vm.$slots['upload-label'])?_vm._t(\"default\",[_vm._v(\"重新上传\")],{\"slot\":\"select-label\"}):_vm._t(\"upload-label\",null,{\"slot\":\"select-label\"})],2)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div :class=\"['zk-image-upload', { 'zk-image-upload-loading': isUpload }]\">\r\n    <div class=\"zk-image-upload-progress\">\r\n      <div class=\"zk-progress\" :style=\"`padding-top: ${ uploadProgress }%;`\">\r\n        <div class=\"zk-progress-bar\"></div>\r\n        <div class=\"zk-progress-text\">\r\n          <span>{{ uploadProgress }}%</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <zk-image-select\r\n      v-model=\"src\"\r\n      ref=\"imageSelect\"\r\n      :view-src-list=\"viewSrcList\"\r\n      :options=\"currentOptions\"\r\n      :readonly=\"readonly\"\r\n      :cover=\"cover\"\r\n      @change-file=\"changeFile\">\r\n      <slot name=\"label\" slot=\"label\"></slot>\r\n      <slot v-if=\"!$slots['upload-label']\" slot=\"select-label\">重新上传</slot>\r\n      <slot v-else name=\"upload-label\" slot=\"select-label\"></slot>\r\n    </zk-image-select>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport ImageSelect from '../../image-select'\r\nimport { MessageBox } from '../../message-box'\r\n\r\nconst msgbox = MessageBox.msgbox\r\n\r\nexport default {\r\n  name: 'ZkImageUpload',\r\n  components: {\r\n    'zk-image-select': ImageSelect\r\n  },\r\n  props: {\r\n    value: String,\r\n    options: Object,\r\n    viewSrcList: Array,\r\n    readonly: {\r\n      type: Boolean,\r\n      required: false\r\n    },\r\n    cover: {\r\n      type: Boolean,\r\n      required: false\r\n    },\r\n    httpRequest: {\r\n      type: Function,\r\n      required: true\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      src: this.value,\r\n      currentValue: this.value,\r\n      isUpload: false,\r\n      uploadProgress: 0\r\n    }\r\n  },\r\n  computed: {\r\n    currentOptions () {\r\n      return Object.assign({\r\n      }, this.options || {})\r\n    }\r\n  },\r\n  watch: {\r\n    value () {\r\n      this.src = this.value\r\n      this.currentValue = this.value\r\n    },\r\n    currentValue () {\r\n      if (!this.currentValue) {\r\n        this.$emit('upload-result', undefined)\r\n      }\r\n      this.$emit('input', this.currentValue)\r\n    }\r\n  },\r\n  methods: {\r\n    changeFile (file) {\r\n      if (!file) {\r\n        this.currentValue = ''\r\n        return\r\n      }\r\n      this.uploadProgress = 0\r\n      this.isUpload = true\r\n      this.httpRequest({\r\n        data: { file },\r\n        onProgress: (e) => {\r\n          this.uploadProgress = ((e.loaded / e.total * 100) | 0)\r\n        },\r\n        onSuccess: result => {\r\n          this.currentValue = result\r\n          this.src = this.currentValue\r\n          this.isUpload = false\r\n        },\r\n        onError: error => {\r\n          this.currentValue = ''\r\n          this.src = ''\r\n          this.isUpload = false\r\n          msgbox.alert(String(error) || '上传失败，请检查网络是否再正常，再重新上传。', '上传失败', {\r\n            closeOnClickModal: true,\r\n            confirmButtonText: '重新上传',\r\n            callback: action => {\r\n              if (!this.$refs.imageSelect) return\r\n              if (action !== 'confirm') return\r\n              return this.$refs.imageSelect.selectImage()\r\n            }\r\n          })\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.zk-image-upload {\r\n  position: relative;\r\n  display: inline-block;\r\n}\r\n.zk-image-upload-progress {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  color: #fff;\r\n  transition: opacity .2s cubic-bezier(.645,.045,.355,1);\r\n  z-index: 1;\r\n  display: none;\r\n  .zk-progress {\r\n    position: relative;\r\n    width: 100%;\r\n    height: 100%;\r\n    box-sizing: border-box;\r\n    transition: padding-top .2s;\r\n    overflow: hidden;\r\n    .zk-progress-bar {\r\n      width: 100%;\r\n      height: 100%;\r\n      text-align: center;\r\n      padding: 13px;\r\n      background-color: rgba(52, 52, 52, .6);\r\n      box-sizing: border-box;\r\n    }\r\n    .zk-progress-text {\r\n      position: absolute;\r\n      top: 0;\r\n      left: 0;\r\n      z-index: 1;\r\n      width: 100%;\r\n      height: 100%;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      white-space: nowrap;\r\n    }\r\n  }\r\n}\r\n.zk-image-upload-loading .zk-image-upload-progress {\r\n  display: block;\r\n}\r\n.zk-image-upload-loading /deep/ .zk-image-item-operating {\r\n  display: none !important;\r\n}\r\n</style>\r\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./image-upload.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./image-upload.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./image-upload.vue?vue&type=template&id=18491148&scoped=true&\"\nimport script from \"./image-upload.vue?vue&type=script&lang=js&\"\nexport * from \"./image-upload.vue?vue&type=script&lang=js&\"\nimport style0 from \"./image-upload.vue?vue&type=style&index=0&id=18491148&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"18491148\",\n  null\n  \n)\n\nexport default component.exports","import ImageUpload from './src/image-upload'\r\n\r\nImageUpload.install = function (Vue) {\r\n  Vue.component(ImageUpload.name, ImageUpload)\r\n}\r\n\r\nexport default ImageUpload\r\n"],"sourceRoot":""}